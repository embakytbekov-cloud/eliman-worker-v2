<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Доступные заказы | Eliman Worker</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body {
      background: #000;
      color: #fff;
      font-family: system-ui, -apple-system, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }

    #ordersList {
      animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .nav-blur {
      background: rgba(10, 10, 10, 0.8);
      backdrop-filter: blur(10px);
      border-top: 1px solid #1f1f1f;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: #9ca3af;
    }

    .nav-item.active {
      color: #3fc060;
    }

    .loader {
      border: 3px solid #1f1f1f;
      border-top: 3px solid #3fc060;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body class="pb-24">

  <header class="p-6 sticky top-0 bg-black z-10">
    <h1 class="text-3xl font-extrabold tracking-tight">Заказы</h1>
    <p class="text-gray-400 text-sm mt-1">Доступно для вашей категории</p>
  </header>

  <main class="px-5" id="ordersList">
    <div class="text-center mt-20">
      <div class="loader"></div>
      <p class="text-gray-500 text-sm mt-4">Поиск подходящих заказов...</p>
    </div>
  </main>

  <nav class="fixed bottom-0 left-0 right-0 h-20 nav-blur flex items-center justify-around px-4 z-20">
    <a href="orders.html" class="nav-item active">
      <svg class="w-6 h-6 mb-1" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      <span>Заказы</span>
    </a>
    <a href="#" class="nav-item">
      <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
      <span>Активные</span>
    </a>
    <a href="#" class="nav-item">
      <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/></svg>
      <span>Маркет</span>
    </a>
    <a href="profile.html" class="nav-item">
      <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
      <span>Профиль</span>
    </a>
  </nav>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <script>
    // Фикс для синхронизации ID с базой данных
    if (window.Telegram && window.Telegram.WebApp) {
      const tg = window.Telegram.WebApp;
      tg.expand();
      
      if (tg.initDataUnsafe?.user?.id) {
        // Принудительно превращаем в строку и убираем лишнее
        const cleanId = String(tg.initDataUnsafe.user.id).trim();
        localStorage.setItem("telegram_id", cleanId);
        console.log("Clean ID for Database:", cleanId);
      }
    }
  </script>

  <script src="js/supabase.js"></script>
  <script src="js/orders.js"></script>

</body>
</html>
