<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Privacy Policy | Eliman Worker</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/supabase.js"></script>

  <style>
    body { background:#0f172a; color:white; padding:20px;}
    .btn-disabled { opacity:0.4; pointer-events:none; }
  </style>
</head>

<body>

  <h1 id="title" class="text-3xl font-bold mb-4">Privacy Policy</h1>

  <div id="content"
       class="bg-slate-800 p-4 rounded-xl h-80 overflow-y-scroll text-sm leading-relaxed mb-6">
  </div>

  <label class="flex items-center mb-6">
    <input id="agree" type="checkbox" class="mr-3">
    <span id="agreeLabel">I agree to the Privacy Policy</span>
  </label>

  <button id="nextBtn"
          class="w-full bg-green-500 py-3 rounded-xl font-bold text-lg btn-disabled">
    Accept & Continue
  </button>

<script>
  const agree = document.getElementById("agree");
  const nextBtn = document.getElementById("nextBtn");
  const title = document.getElementById("title");
  const content = document.getElementById("content");
  const agreeLabel = document.getElementById("agreeLabel");

  const params = new URLSearchParams(window.location.search);
  const lang = params.get("lang") || "en";

  // ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π ID –∏–∑ URL
  const workerId = params.get("worker_id");

  if (!workerId) {
    alert("Worker ID missing");
  }

  // üåç I18N
  const i18n = {
    en: {
      title: "Privacy Policy",
      agree: "I agree to the Privacy Policy",
      next: "Accept & Continue",
      content: `
        <h2 class="font-bold text-lg mb-2">1. Information We Collect</h2>
        <p class="mb-4">
          We collect profile data, contact information, location (for job matching),
          work photos, device information, activity logs, and payment info.
        </p>

        <h2 class="font-bold text-lg mb-2">2. How We Use Data</h2>
        <p class="mb-4">
          Data is used to match workers with clients, prevent fraud, process payments,
          and improve the platform.
        </p>

        <h2 class="font-bold text-lg mb-2">3. Sharing Data</h2>
        <p class="mb-4">
          We may share limited info with clients, payment processors, or legal authorities.
          We never sell personal data.
        </p>

        <h2 class="font-bold text-lg mb-2">4. Location</h2>
        <p class="mb-4">
          Location is used only when you are online for job matching.
        </p>

        <h2 class="font-bold text-lg mb-2">5. Security</h2>
        <p class="mb-4">
          Your data is encrypted. You are responsible for device security.
        </p>

        <h2 class="font-bold text-lg mb-2">6. Account Deletion</h2>
        <p class="mb-4">
          You may request deletion anytime. Some payment-related records must remain.
        </p>
      `
    },

    ru: {
      title: "–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏",
      agree: "–Ø –ø—Ä–∏–Ω–∏–º–∞—é –ü–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏",
      next: "–ü—Ä–∏–Ω—è—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å",
      content: `
        <h2 class="font-bold text-lg mb-2">1. –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –º—ã —Å–æ–±–∏—Ä–∞–µ–º</h2>
        <p class="mb-4">
          –ú—ã —Å–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è, –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ,
          —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Ä–∞–±–æ—Ç, –¥–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –¥–∞–Ω–Ω—ã–µ –æ–ø–ª–∞—Ç—ã.
        </p>

        <h2 class="font-bold text-lg mb-2">2. –ö–∞–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ</h2>
        <p class="mb-4">
          –î–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞,
          –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.
        </p>

        <h2 class="font-bold text-lg mb-2">3. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
        <p class="mb-4">
          –î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–¥–∞–Ω—ã –∫–ª–∏–µ–Ω—Ç–∞–º, –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º –∏–ª–∏ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é –∑–∞–∫–æ–Ω–∞.
          –ú—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ–¥–∞—ë–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
        </p>

        <h2 class="font-bold text-lg mb-2">4. –õ–æ–∫–∞—Ü–∏—è</h2>
        <p class="mb-4">
          –õ–æ–∫–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤—ã –æ–Ω–ª–∞–π–Ω –∏ –∏—â–µ—Ç–µ –∑–∞–∫–∞–∑—ã.
        </p>

        <h2 class="font-bold text-lg mb-2">5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h2>
        <p class="mb-4">
          –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã. –í—ã –æ—Ç–≤–µ—á–∞–µ—Ç–µ –∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
        </p>

        <h2 class="font-bold text-lg mb-2">6. –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞</h2>
        <p class="mb-4">
          –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ –∑–∞–∫–æ–Ω—É.
        </p>
      `
    },

    es: {
      title: "Pol√≠tica de Privacidad",
      agree: "Acepto la Pol√≠tica de Privacidad",
      next: "Aceptar y Continuar",
      content: `
        <h2 class="font-bold text-lg mb-2">1. Datos que recopilamos</h2>
        <p class="mb-4">
          Recopilamos datos de perfil, contacto, ubicaci√≥n, fotos de trabajo,
          informaci√≥n del dispositivo, actividad y pago.
        </p>

        <h2 class="font-bold text-lg mb-2">2. C√≥mo usamos los datos</h2>
        <p class="mb-4">
          Usamos los datos para emparejar trabajos, prevenir fraude,
          procesar pagos y mejorar la plataforma.
        </p>

        <h2 class="font-bold text-lg mb-2">3. Compartir datos</h2>
        <p class="mb-4">
          Podemos compartir informaci√≥n con clientes, procesadores de pago o autoridades legales.
          Nunca vendemos datos personales.
        </p>

        <h2 class="font-bold text-lg mb-2">4. Ubicaci√≥n</h2>
        <p class="mb-4">
          La ubicaci√≥n se usa solo cuando est√°s online y buscando pedidos.
        </p>

        <h2 class="font-bold text-lg mb-2">5. Seguridad</h2>
        <p class="mb-4">
          Tus datos est√°n encriptados. Eres responsable por tu dispositivo.
        </p>

        <h2 class="font-bold text-lg mb-2">6. Eliminaci√≥n de cuenta</h2>
        <p class="mb-4">
          Puedes solicitar eliminaci√≥n del perfil. Algunos registros quedan por obligaci√≥n legal.
        </p>
      `
    }
  };

  // apply language
  title.textContent = i18n[lang].title;
  agreeLabel.textContent = i18n[lang].agree;
  nextBtn.textContent = i18n[lang].next;
  content.innerHTML = i18n[lang].content;

  agree.addEventListener("change", () => {
    agree.checked
      ? nextBtn.classList.remove("btn-disabled")
      : nextBtn.classList.add("btn-disabled");
  });

  // ‚úÖ –í–∞–∂–Ω–∞—è –ø—Ä–∞–≤–∫–∞ ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º –ø–æ telegram_id
  nextBtn.addEventListener("click", async () => {
    if (!agree.checked) return;

    const { error } = await window.db
      .from("workers")
      .update({ accepted_privacy: true })
      .eq("telegram_id", workerId);

    if (error) {
      console.error(error);
      alert("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–∑—ã");
      return;
    }

    window.location.href = `work_agreement.html?worker_id=${workerId}&lang=${lang}`;
  });
</script>

</body>
</html> 